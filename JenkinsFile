pipeline {
  // ระบุ agent ที่ใช้รัน pipeline (สามารถระบุ node label เฉพาะได้ถ้าต้องการ)
  agent any

  // กำหนด environment variables (ถ้ามี)
  environment {
     NETLIFY_SITE_ID = '42dd4a42-af36-4c76-80fe-2ee8c85ccffe'
        NETLIFY_AUTH_TOKEN = credentials('netlify-token')
  }

  stages {
    stage('Build') {
      steps {
        echo 'เริ่มการ Build แอพพลิเคชัน...'
        // ตัวอย่างคำสั่ง Build (ปรับแก้ไขตามความเหมาะสม)
        sh 'npm install'
        sh 'npm run build'
      }
    }

    stage('Test') {
      steps {
        echo 'เริ่มการทดสอบแอพพลิเคชัน...'
        // ตัวอย่างคำสั่งทดสอบ (ปรับแก้ไขตามความเหมาะสม)
        sh 'npm test'
      }
    }

    stage('Deploy') {
      steps {
        echo "Deploy แอพ ${APP_NAME} ไปยัง environment: ${DEPLOY_ENV}"
        // ตัวอย่างคำสั่ง deploy (ปรับแก้ไขให้ตรงกับ environment deployment ของคุณ)
        // เช่น ใช้คำสั่ง scp, ssh, หรือเรียกใช้งาน script ที่เตรียมไว้สำหรับ deploy
        sh './deploy.sh'
      }
    }

    stage('Post deploy') {
      steps {
        echo 'ดำเนินการหลังการ Deploy...'
        // ตัวอย่างคำสั่งตรวจสอบสถานะ deployment หรือแจ้งเตือน
        sh './postDeployCheck.sh'
      }
    }
  }

  // ส่วน post สำหรับจัดการกับผลลัพธ์หลัง pipeline ทำงานเสร็จสิ้น
  post {
    always {
      echo 'Pipeline สิ้นสุดลงแล้ว - ทำความสะอาดงานหรือแจ้งเตือนได้ที่นี่'
      // ตัวอย่างคำสั่ง cleanup
      sh 'rm -rf temp/'
    }
    success {
      echo 'Pipeline ทำงานสำเร็จ'
    }
    failure {
      echo 'Pipeline พบข้อผิดพลาด'
    }
  }
}
